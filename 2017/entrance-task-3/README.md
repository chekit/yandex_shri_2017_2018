# Задание 3

Мобилизация.Гифки – сервис для поиска гифок в перерывах между занятиями.

Сервис написан с использованием [bem-components](https://ru.bem.info/platform/libs/bem-components/5.0.0/).

Работа избранного в оффлайне реализована с помощью технологии [Service Worker](https://developer.mozilla.org/ru/docs/Web/API/Service_Worker_API/Using_Service_Workers).

Для поиска изображений используется [API сервиса Giphy](https://github.com/Giphy/GiphyAPI).

В браузерах, не поддерживающих сервис-воркеры, приложение так же должно корректно работать, 
за исключением возможности работы в оффлайне.

## Структура проекта

  * `gifs.html` – точка входа
  * `assets` – статические файлы проекта
  * `vendor` –  статические файлы внешних библиотек
  * `service-worker.js` – скрипт сервис-воркера

Открывать `gifs.html` нужно с помощью локального веб-сервера – не как файл. 
Это можно сделать с помощью встроенного в WebStorm/Idea веб-сервера, с помощью простого сервера
из состава PHP или Python. Можно воспользоваться и любым другим способом.

## Решение 

- Чтобы *Service Worker* смог обрабатывать **все** запросы нужно вынести его в корневую дирректорию, а так у нас ограничивается его область действия папкой `./assets`.

- После выноса файла в корневую дирректорию необходимо было изменить путь до него при регистрации Service Worker в blocks.js (`.register('./service-worker.js')`), а так же обращение к библиотеке kv-keeper `importScripts('./vendor/kv-keeper.js-1.0.4/kv-keeper.js');`

- В функции `needStoreForOffline` отсутсвовала проверка на `gifs.html` после её добавления всё заработало.


## Ответы на вопросы в `service-worker.js`

### Вопрос №1 и Вопрос №2

*skipWaiting* - это метод из глобальной области видимости Sevice Wroker'ов, который "застявляет" ожидающего активации service worker стать активным (вызывается событие 'active')

Вызов `self.clients.claim();` позволяет активированному Service Worker установить себя, как активный для клиента, когда сервис и страница в одной области видимости. Позволяет Service Worker обновлять себя без перезагрузки страницы.

### Вопрос №3:

Предполагаю, что не во всех. При get запросах часть `?text=<text message>` не будет учитываться

### Вопрос №4:

Данная часть кода фильтрует массив ключей соответствующих именам кэшей и на выходе возвращает массив с ключами, которые не равны значению `CACHE_VERSION`, далее перебирется отфильрованный массив и его значения (имена старых кэшэй) позволяют удалить неактуальные данные (устаревшие кэши).

### Вопрос №5:

Объект response может быть прочитан единожды, поэтому, чтобы не потерять его значение мы делаем clone (https://developer.mozilla.org/ru/docs/Web/API/Service_Worker_API/Using_Service_Workers)
